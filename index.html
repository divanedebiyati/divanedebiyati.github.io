<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vezin Sesli Okuma</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            overflow-x: auto;
        }
        h1 {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .vezin-container {
            margin-bottom: 40px;
            cursor: pointer;
        }
        .bar-container {
            display: inline-block;
            margin-right: 4px;
            text-align: center;
        }
        .bar {
            transition: background-color 0.3s;
        }
        .long {
            width: 20px;
            height: 40px;
        }
        .short {
            width: 20px;
            height: 20px;
        }
        .highlight {
            background-color: #fff;
        }
        .hece {
            font-size: 12px;
            transition: color 0.3s;
            margin-top: 5px;
            word-wrap: break-word;
            max-width: 20px;
        }
        .hece.highlight {
            color: #fff;
        }
        .spacer {
            display: inline-block;
            width: 20px;
            height: 40px;
        }
        #vezin-0 .bar { background-color: #cc0000; }
        #vezin-0 .hece { color: #cc0000; }
        #vezin-1 .bar { background-color: #cc6600; }
        #vezin-1 .hece { color: #cc6600; }
        #vezin-2 .bar { background-color: #cccc00; }
        #vezin-2 .hece { color: #cccc00; }
        #vezin-3 .bar { background-color: #00cc00; }
        #vezin-3 .hece { color: #00cc00; }
        #vezin-4 .bar { background-color: #0000cc; }
        #vezin-4 .hece { color: #0000cc; }
        #vezin-5 .bar { background-color: #330066; }
        #vezin-5 .hece { color: #330066; }
        
        @media (max-width: 600px) {
            .bar-container {
                margin-right: 2px;
            }
            .long, .short {
                width: 15px;
            }
            .long {
                height: 30px;
            }
            .short {
                height: 15px;
            }
            .spacer {
                width: 15px;
            }
            .hece {
                font-size: 10px;
            }
            h1 {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <h1>ARUZ VEZNİ</h1>
    <div>
        <a href="https://hits.seeyoufarm.com">
            <img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fdivanedebiyati.github.io&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false"/>
        </a>
    </div>
    <div id="veznContainers"></div>

    <script>
        const vezinler = [
            { pattern: "-.--/-.--/-.--/-.-", heceler: ["fâ", "i", "lâ", "tün", "fâ", "i", "lâ", "tün", "fâ", "i", "lâ", "tün", "fâ", "i", "tün"] },
            { pattern: "..--/..--/..--/..-", heceler: ["fe", "i", "lâ", "tün", "fe", "i", "lâ", "tün", "fe", "i", "lâ", "tün", "fe", "i", "lün"] },
            { pattern: ".---/.---/.---/.---", heceler: ["me", "fâ", "î", "lün", "me", "fâ", "î", "lün", "me", "fâ", "î", "lün", "me", "fâ", "î", "lün"] },
            { pattern: "--./-.-./.--./-.-", heceler: ["mef", "û", "lü", "fâ", "i", "lâ", "tü", "me", "fâ", "î", "lü", "fâ", "i", "lün"] },
            { pattern: "--./.--./.--./.--", heceler: ["mef", "û", "lü", "me", "fâ", "î", "lü", "me", "fâ", "î", "lü", "fe", "û", "lün"] },
            { pattern: ".-.-/..--/.-.-/..-", heceler: ["me", "fâ", "i", "lün", "fe", "i", "lâ", "tün", "me", "fâ", "i", "lün", "fe", "i", "lün"] }
        ];

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let activeTimeouts = [];
        let activeOscillators = [];

        function playEmChord(duration, instrument = 'guitar') {
            const frequencies = [164.81, 196.00, 246.94];
            const gainNode = audioContext.createGain();
            gainNode.connect(audioContext.destination);
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);

            frequencies.forEach(freq => {
                const oscillator = audioContext.createOscillator();
                oscillator.frequency.setValueAtTime(freq, audioContext.currentTime);
                oscillator.type = instrument === 'guitar' ? 'sawtooth' : 'sine';
                oscillator.connect(gainNode);
                oscillator.start();
                activeOscillators.push(oscillator);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);
                setTimeout(() => oscillator.stop(), duration);
            });
        }

        function stopAll() {
            activeTimeouts.forEach(timeout => clearTimeout(timeout));
            activeTimeouts = [];
            activeOscillators.forEach(osc => osc.stop());
            activeOscillators = [];
            document.querySelectorAll('.bar').forEach(bar => bar.classList.remove('highlight'));
            document.querySelectorAll('.hece').forEach(hece => hece.classList.remove('highlight'));
        }

        function createBars() {
            const containersDiv = document.getElementById('veznContainers');
            containersDiv.innerHTML = '';

            vezinler.forEach((vezin, index) => {
                const vezinContainer = document.createElement('div');
                vezinContainer.classList.add('vezin-container');
                vezinContainer.id = `vezin-${index}`;
                let heceIndex = 0;

                for (let char of vezin.pattern) {
                    if (char === '-' || char === '.') {
                        const barContainer = document.createElement('div');
                        barContainer.classList.add('bar-container');

                        const bar = document.createElement('div');
                        bar.classList.add('bar');
                        if (char === '-') {
                            bar.classList.add('long');
                        } else if (char === '.') {
                            bar.classList.add('short');
                        }

                        const hece = document.createElement('div');
                        hece.classList.add('hece');
                        hece.textContent = vezin.heceler[heceIndex];
                        heceIndex++;

                        barContainer.appendChild(bar);
                        barContainer.appendChild(hece);
                        vezinContainer.appendChild(barContainer);
                    } else if (char === '/') {
                        const spacer = document.createElement('div');
                        spacer.classList.add('spacer');
                        vezinContainer.appendChild(spacer);
                    }
                }
                containersDiv.appendChild(vezinContainer);
                vezinContainer.addEventListener('click', () => {
                    stopAll();
                    startAnimation(index);
                });
            });
        }

        function startAnimation(vezinIndex) {
            const vezin = vezinler[vezinIndex];
            const vezinContainer = document.getElementById(`vezin-${vezinIndex}`);
            const barContainers = vezinContainer.querySelectorAll('.bar-container');
            let delay = 0;
            let barIndex = 0;

            for (let char of vezin.pattern) {
                if (char === '-') {
                    const barContainer = barContainers[barIndex];
                    const bar = barContainer.querySelector('.bar');
                    const hece = barContainer.querySelector('.hece');
                    const timeout = setTimeout(() => {
                        bar.classList.add('highlight');
                        hece.classList.add('highlight');
                        playEmChord(400, 'guitar');
                        setTimeout(() => {
                            bar.classList.remove('highlight');
                            hece.classList.remove('highlight');
                        }, 400);
                    }, delay);
                    activeTimeouts.push(timeout);
                    delay += 400;
                    barIndex++;
                } else if (char === '.') {
                    const barContainer = barContainers[barIndex];
                    const bar = barContainer.querySelector('.bar');
                    const hece = barContainer.querySelector('.hece');
                    const timeout = setTimeout(() => {
                        bar.classList.add('highlight');
                        hece.classList.add('highlight');
                        playEmChord(200, 'piano');
                        setTimeout(() => {
                            bar.classList.remove('highlight');
                            hece.classList.remove('highlight');
                        }, 200);
                    }, delay);
                    activeTimeouts.push(timeout);
                    delay += 200;
                    barIndex++;
                } else if (char === '/') {
                    delay += 500;
                }
            }
        }

        window.onload = createBars;
    </script>
</body>
</html>
